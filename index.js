(()=>{"use strict";function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e,n){for(var a=0;a<n.length;a++){var r=n[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,t(r.key),r)}}function t(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var a=n[Symbol.toPrimitive];if(void 0!==a){var r=a.call(n,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==e(t)?t:String(t)}const a=new(function(){function e(){var n,a,r;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,r=[],(a=t(a="panoramas"))in n?Object.defineProperty(n,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[a]=r}var a,r;return a=e,(r=[{key:"loadPanos",value:function(e){this.panoramas=e}},{key:"findPano",value:function(e){return this.panoramas.find((function(n){return n.id===e}))}}])&&n(a.prototype,r),Object.defineProperty(a,"prototype",{writable:!1}),e}());var r,i,o=73;const l={RES_16K:!0,geometry:(c=[{tileSize:256,size:256,fallbackOnly:!0},{tileSize:512,size:512},{tileSize:512,size:1024},{tileSize:512,size:2048}],c.push({tileSize:512,size:4096}),new Marzipano.CubeGeometry(c)),view:new Marzipano.RectilinearView(null,Marzipano.RectilinearView.limit.traditional(8192,120*Math.PI/180)),setViewer:function(e){r=new Marzipano.Viewer(e,{stage:{progressive:!0},controls:{scrollZoom:!0}})},getViewer:function(){return r},setAngle:function(e){o=e},getAngle:function(){return o},setActivePano:function(e){i=e},getActivePano:function(){return i}};var c;function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,p(a.key),a)}}function p(e){var n=function(e,n){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=u(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(n)?n:String(n)}var d="https://img.gothru.org/";function g(e,n,t,a,r,i,o){var c=6144*o/3,u=function(e,n){switch(e){case"f":return{x1:0,y1:0,x2:n,y2:n};case"b":return{x1:n,y1:0,x2:2*n,y2:n};case"u":return{x1:2*n,y1:0,x2:3*n,y2:n};case"d":return{x1:0,y1:n,x2:n,y2:2*n};case"l":return{x1:n,y1:n,x2:2*n,y2:2*n};case"r":return{x1:2*n,y1:n,x2:3*n,y2:2*n};default:throw new Error("Invalid face value")}}(e,c),s=c/Math.pow(2,(n||1)-1),p={x1:u.x1+s*(t-1),y1:u.y1+s*(a-1),x2:u.x1+s*t,y2:u.y1+s*a},g=l.RES_16K?"&pad=bg:000016":"";return"".concat(d,"cube/").concat(r.replace(".jpg","_".concat(i,".jpg")),"?crop=").concat(p.x1,"x").concat(p.y1,"x").concat(p.x2,"x").concat(p.y2).concat("&resize=512x512","&").concat("save=optimize,progressive,qual:70").concat(g)}var v=[],f=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,t;return n=e,t=[{key:"createImageUrlSource",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=e.url.split("?"),a=t[0],r=parseInt(t[1].split(":")[1]),i=l.RES_16K?2:1;return new Marzipano.ImageUrlSource((function(e){if(0!==e.z||n)return{url:g(e.face,e.z,e.x+1,e.y+1,a,r,i)};var t="lfrbud".indexOf(e.face)/6;return{url:"".concat(d,"cube/").concat(a.replace(".jpg","_thumb_".concat(r,".jpg")),"?save=optimize,progressive,qual:70"),rect:{x:0,y:t,width:1,height:1/6}}}),{concurrency:10})}},{key:"createScene",value:function(e){var n=l.geometry,t=l.view,a=this.createImageUrlSource(e);return l.getViewer().createScene({source:a,geometry:n,view:t,pinFirstLevel:!0})}},{key:"addScene",value:function(e){var n=this.createScene(e);return v.push({id:e.id,scene:n}),n}},{key:"loadScene",value:function(e){var n,t;return(n=e.id,null===(t=v.find((function(e){return e.id===n})))||void 0===t?void 0:t.scene)||this.addScene(e)}}],t&&s(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),e}();const m=new f;var y=[],b="http://www.w3.org/2000/svg",_=[{class:"shadow",d:"M 0 -100 L 40 -60 L 30 -50 L 0 -82 L -30 -50 L -40 -60"},{class:"arrow",d:"M 0 -100 L 40 -60 L 30 -50 L 0 -82 L -30 -50 L -40 -60"},{class:"placeholder",d:"M 0 -120 L 60 -60 L 40 -30 L -40 -30 L -60 -60 L 0 -120"}],h=function(e,n){var t=-1*l.getViewer().scene().view().pitch()*180/Math.PI,a=w(l.getViewer()._size.width/2),r=w(l.getViewer()._size.height*(78+t)/100);"shadow"==n&&(r+=3);var i=w(1-(.667+.262*t/90));t<=0&&(i=w(.333+.667*t/-90));var o=w(e-l.getAngle()+l.getActivePano().north_angle);return"translate(".concat(a,", ").concat(r,") scale(1, ").concat(i,") rotate(").concat(o,")")},w=function(e){return parseFloat(e.toFixed(2))},x=function(){};const S=function(){var e=document.getElementById("arrows");e&&e.remove(),y=[]},z=function(e){var n=document.getElementById("arrows");n||((n=document.createElementNS(b,"svg")).setAttribute("id","arrows"),l.getViewer().domElement().appendChild(n));var t=document.createElementNS(b,"g");t.addEventListener("click",(function(){x(e)}));var a=_.map((function(n){return t=n,a=e.angle,(r=document.createElementNS(b,"path")).setAttribute("d",t.d),r.setAttribute("class",t.class),r.setAttribute("transform",h(a,t.class)),r;var t,a,r}));a.forEach((function(e){return t.appendChild(e)})),y.push({id:e.id,angle:e.angle,shapes:a}),n.appendChild(t)},L=function(){y.forEach((function(e){e.shapes.forEach((function(n){n.setAttribute("transform",h(e.angle,n.className.baseVal))}))}))},P=function(e){x=e};var j={x:0,y:0,z:0};function k(e,n,t,a){var r=l.view,i=n-0,o=t-0,c=a-0;Marzipano.util.tween(e,(function(e){r.setTx(0+i*e),r.setTy(0+o*e),r.setTz(0+c*e)}),(function(){}))}const M=function(e){!function(e,n){var t=e*Math.PI/180,a=Number((.2*Math.cos(t)).toFixed(2)),r=Number((.2*Math.sin(t)).toFixed(2));j.x=a,j.y=0,j.z=r}(e.angle-l.getAngle()+l.getActivePano().north_angle-90+180*l.getViewer().view().yaw()/Math.PI),k(500,j.x,j.y,j.z)},A=function(){setTimeout((function(){k(0,0,0,0),j.x=0,j.y=0,j.z=0}),501)};a.loadPanos([{id:40832560,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060034.UJ6aei.jpg?pad=bg:000002",sequence:1,north_angle:283.9,links:[{id:40832548,angle:290}],moderation_id:3220065,pano_id:"",latlong:{lat:72239480824863e-18,lng:79560229073487e-18},next_pano:40832548,prev_pano:40832558,p3d:0},{id:40832548,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060047.c7TCzy.jpg?pad=bg:000002",sequence:2,north_angle:335.4,links:[{id:40832560,angle:59},{id:40832554,angle:297}],moderation_id:3220065,pano_id:"",latlong:{lat:49819812202826e-18,lng:64551569084557e-18},next_pano:40832549,prev_pano:40832560,p3d:0},{id:40832549,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060102.Krmz7c.jpg?pad=bg:000002",sequence:3,north_angle:171.20000000000005,links:[{id:40832551,angle:321}],moderation_id:3220065,pano_id:"",latlong:{lat:95509887797803e-18,lng:20978594896473e-18},next_pano:40832550,prev_pano:40832548,p3d:0},{id:40832550,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060116.joWQ6i.jpg?pad=bg:000002",sequence:4,north_angle:254.5,links:[{id:40832551,angle:341}],moderation_id:3220065,pano_id:"",latlong:{lat:92746063881097e-18,lng:63146399250954e-18},next_pano:40832551,prev_pano:40832549,p3d:0},{id:40832551,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060130.bThTAC.jpg?pad=bg:000003",sequence:5,north_angle:13,links:[{id:40832554,angle:174.2000000000037},{id:40832550,angle:42.30000000000143},{id:40832549,angle:299.2000000000003}],moderation_id:3220065,pano_id:"",latlong:{lat:77387102624249e-18,lng:40965242272637e-18},next_pano:40832552,prev_pano:40832550,p3d:0},{id:40832552,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060143.zp0XMc.jpg?pad=bg:000002",sequence:6,north_angle:3.1000000000000227,links:[{id:40832553,angle:277.00000000000887}],moderation_id:3220065,pano_id:"",latlong:{lat:1892252910915e-17,lng:64992796380434e-18},next_pano:40832553,prev_pano:40832551,p3d:0},{id:40832553,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060156.cXQgkj.jpg?pad=bg:000002",sequence:7,north_angle:307.5,links:[{id:40832554,angle:50.700000000000784},{id:40832552,angle:153}],moderation_id:3220065,pano_id:"",latlong:{lat:23653861681165e-18,lng:38431246955031e-18},next_pano:40832554,prev_pano:40832552,p3d:0},{id:40832554,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060210.bS49Ly.jpg?pad=bg:000002",sequence:8,north_angle:304.9,links:[{id:40832555,angle:330},{id:40832553,angle:234},{id:40832551,angle:63},{id:40832548,angle:147}],moderation_id:3220065,pano_id:"",latlong:{lat:50620197030998e-18,lng:37583795726113e-18},next_pano:40832555,prev_pano:40832553,p3d:0},{id:40832555,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060224.RQWrme.jpg?pad=bg:000002",sequence:9,north_angle:312,links:[{id:40832556,angle:244},{id:40832554,angle:143}],moderation_id:3220065,pano_id:"",latlong:{lat:52783935793615e-18,lng:10691052274528e-18},next_pano:40832556,prev_pano:40832554,p3d:0},{id:40832556,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060238.rGIw2i.jpg?pad=bg:000002",sequence:10,north_angle:294.09999999999997,links:[{id:40832558,angle:254},{id:40832555,angle:81}],moderation_id:3220065,pano_id:"",latlong:{lat:26723596834715e-18,lng:37082054960072e-19},next_pano:40832558,prev_pano:40832555,p3d:0},{id:40832558,url:"2/sv_mL5NbvriYHlO4au3fB/20230724060251.LV6joy.jpg?pad=bg:000002",sequence:11,north_angle:0,links:[{id:40832556,angle:7.900000000000089}],moderation_id:3220065,pano_id:"",latlong:{lat:0,lng:0},next_pano:40832560,prev_pano:40832556,p3d:0}]);var E=Marzipano.RectilinearView.limit.traditional(4096,100*Math.PI/180),O=new Marzipano.RectilinearView({oz:2,invertControl:!0},E);l.view=O,l.geometry=new Marzipano.CubeGeometry([{tileSize:4096,size:4096}]),m.createScene=function(e){var n=l.geometry,t=l.view,a=m.createImageUrlSource(e,!0);return l.getViewer().createScene({source:a,geometry:n,view:t,depthmap:"./data/".concat(e.sequence,".stl"),pinFirstLevel:!0})},l.setViewer(document.querySelector("#pano"));var V=l.getViewer();function N(){S(),l.getActivePano().links.forEach((function(e){z(e),m.loadScene(a.findPano(e.id))})),A()}function I(){var e=180*V.scene().view().yaw()/Math.PI;l.setAngle(e+l.getActivePano().north_angle),L()}setTimeout((function(){V.__events.viewChange.push(I),V.__events.sceneChange.push(N)}));var q=function(e){l.setActivePano(a.findPano(e)),m.loadScene(l.getActivePano()).switchTo()};P((function(e){M(e),q(e.id)})),setTimeout((function(){q(a.panoramas[0].id),V.scene().view().setFov(180*Math.PI/180)}),10)})();